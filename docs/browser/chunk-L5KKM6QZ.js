import{a as b}from"./chunk-QCWFXOJC.js";import{a as C,b as U}from"./chunk-RXNGEOLM.js";import"./chunk-Y4GASUIQ.js";import"./chunk-QFBWRPON.js";import"./chunk-RGNDWIHZ.js";import{a as S}from"./chunk-74CHJCYH.js";import{c as O,n as A,p as h,q as B,s as j,t as v,u as y}from"./chunk-WEBSOFYO.js";import{$ as _,Ab as f,Bb as P,D as m,Ib as w,Tb as T,V as s,Vc as L,Wa as R,Xa as l,_ as k,da as M,ea as n,f as c,ja as a,ka as $,pb as d,zb as u}from"./chunk-JPTIIQB7.js";import{a as x,b as E,j as F}from"./chunk-YIRVVMYZ.js";var p=(()=>{let e=class e{constructor(t){this._http=t}getAll(){return this._http.get(`${v.API_BASE_URL}/api/Plan`).pipe(m(y))}get(t){return this._http.get(`${v.API_BASE_URL}/api/Plan/${t}`).pipe(m(y))}create(t){return this._http.post(`${v.API_BASE_URL}/api/Plan`,t).pipe(m(y))}update(t,i){return this._http.put(`${v.API_BASE_URL}/api/Plan/${t}`,i).pipe(m(y))}delete(t){return this._http.delete(`${v.API_BASE_URL}/api/Plan/${t}`).pipe(m(y))}};e.\u0275fac=function(i){return new(i||e)(M(O))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var H=(()=>{let e=class e{constructor(t){this._planService=t,this.data=[],this.destroy$=new c,this.columns=[{key:"title",type:C.Text,header:"Title"},{key:"price",type:C.Text,header:"Min Price"},{key:"duration",type:C.Text,header:"Max Price"},{key:"details",type:C.Action,header:"Edit"},{key:"delete",type:C.Action,header:"Delete"}]}ngOnInit(){this._planService.getAll().pipe(s(this.destroy$)).subscribe({next:t=>{t&&Array.isArray(t.$values)?this.data=t.$values.map(i=>E(x({},i),{details:`/admin/plan/edit/${i.id}`,delete:`/admin/plan/delete/${i.id}`})):console.error("Unexpected response format:",t)},error:t=>{console.error("Error fetching plans:",t)}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};e.\u0275fac=function(i){return new(i||e)(l(p))},e.\u0275cmp=a({type:e,selectors:[["app-list"]],decls:4,vars:2,consts:[["routerLink","../create",1,"w-full","bg-black","text-white","p-2","flex","items-center","justify-center"],["src","../../../../../../../assets/icons/create.svg","alt","create",1,"mr-2","w-[20px]"],[1,"w-full",3,"data","columns"]],template:function(i,o){i&1&&(u(0,"a",0),P(1,"img",1),T(2,` Create New Plan
`),f(),P(3,"app-ui-datatable",2)),i&2&&(R(3),d("data",o.data)("columns",o.columns))},dependencies:[B,U]});let r=e;return r})();var q=(()=>{let e=class e{constructor(){this.planService=n(p),this.route=n(A),this.router=n(h),this.alertService=n(S),this.data={},this.labels=["title","price","duration","description"],this.destroy$=new c}ngOnInit(){this.route.paramMap.pipe(s(this.destroy$)).subscribe(t=>{this.planId=t.get("id"),this.planId?this.planService.get(this.planId).pipe(s(this.destroy$)).subscribe({next:i=>{this.data=i},error:i=>{this.alertService.error(i.error.title)}}):this.alertService.error("Id is not valid")})}handleFormSubmit(t){console.log("Form submitted:",t),this.planId?this.planService.update(this.planId,{id:this.planId,title:t.title,description:t.description,price:t.price,duration:t.duration}).pipe(s(this.destroy$)).subscribe({complete:()=>this.alertService.success("plan updated successfully"),error:i=>this.alertService.error(i.error.title)}):this.alertService.error("Id is not valid")}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=a({type:e,selectors:[["app-edit"]],decls:1,vars:6,consts:[[3,"formSubmit","isDetails","showUploader","title","description","labels","data"]],template:function(i,o){i&1&&(u(0,"app-ui-upsert-form",0),w("formSubmit",function(D){return o.handleFormSubmit(D)}),f()),i&2&&d("isDetails",!1)("showUploader",!1)("title","Plan Update")("description","Please fill out the form below")("labels",o.labels)("data",o.data)},dependencies:[b]});let r=e;return r})();var z=(()=>{let e=class e{constructor(){this.planService=n(p),this.router=n(h),this.alertService=n(S),this.data={},this.labels=["title","price","duration","description"],this.destroy$=new c}handleFormSubmit(t){this.planService.create({title:t.title,description:t.description,price:t.price,duration:t.duration}).pipe(s(this.destroy$)).subscribe({complete:()=>this.alertService.success("plan updated successfully"),error:i=>this.alertService.error(i?.error?.title??i)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=a({type:e,selectors:[["app-create"]],decls:1,vars:6,consts:[[3,"formSubmit","isDetails","showUploader","title","description","labels","data"]],template:function(i,o){i&1&&(u(0,"app-ui-upsert-form",0),w("formSubmit",function(D){return o.handleFormSubmit(D)}),f()),i&2&&d("isDetails",!1)("showUploader",!1)("title","Plan Create")("description","Please fill out the form below")("labels",o.labels)("data",o.data)},dependencies:[b]});let r=e;return r})();var G=(()=>{let e=class e{constructor(t,i,o,I){this._planService=t,this._route=i,this._router=o,this._alertService=I}ngOnInit(){this.delete()}ngOnDestroy(){this.deleteSubscription?.unsubscribe()}delete(){return F(this,null,function*(){(yield this._alertService.confirm("Plan Delete","Are you sure you want to delete this plan?"))?this.deleteSubscription=this._route.paramMap.subscribe(i=>{let o=i.get("id");o?this._planService.delete(o).subscribe({complete:()=>{this._alertService.success("Plan deleted successfully"),this._router.navigate(["/admin/plan"])},error:I=>{this._alertService.error(I.error?.title||"An error occurred while deleting the plan")}}):this._alertService.error("Plan Id is not found")}):(this._alertService.error("Confirmation denied"),this._router.navigate(["/admin/plan"]))})}};e.\u0275fac=function(i){return new(i||e)(l(p),l(A),l(h),l(S))},e.\u0275cmp=a({type:e,selectors:[["app-delete"]],decls:0,vars:0,template:function(i,o){},encapsulation:2});let r=e;return r})();var V=[{path:"",pathMatch:"full",redirectTo:"list"},{path:"list",component:H},{path:"edit/:id",component:q},{path:"create",component:z},{path:"delete/:id",component:G}],J=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=$({type:e}),e.\u0275inj=_({imports:[j.forChild(V),j]});let r=e;return r})();var Le=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=$({type:e}),e.\u0275inj=_({imports:[L,J,U,b]});let r=e;return r})();export{Le as PlanManagementModule};
