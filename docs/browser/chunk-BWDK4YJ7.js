import{c as I}from"./chunk-PS6BIUUN.js";import{a as A,c as P,t as c,u as p}from"./chunk-WEBSOFYO.js";import{D as a,X as m,_ as h,da as d,ea as _,gb as $,hb as B,n as k,uc as E,vc as D,za as U}from"./chunk-JPTIIQB7.js";import{a as s,b as g,j}from"./chunk-YIRVVMYZ.js";var et=(()=>{let o=class o{constructor(t,e){this._http=t,this._tokenService=e}register(t){return this._http.post(`${c.API_BASE_URL}/api/Authentication/register/`,t)}login(t){return this._http.post(`${c.API_BASE_URL}/api/Authentication/login/`,t).pipe(m(e=>{this._tokenService.setToken(e.accessToken),this._tokenService.setRefreshToken(e.refreshToken)}),a(e=>(console.error(e),k(()=>e))))}loginWithGoogle(t){return this._http.post(`${c.API_BASE_URL}/api/Authentication/loginWithGoogle`,{idToken:t},{headers:new A({"Content-Type":"application/json"})}).pipe(m(e=>{this._tokenService.setToken(e.accessToken),this._tokenService.setRefreshToken(e.refreshToken)}),a(e=>(console.error(e),k(()=>e))))}sentOtp(t){return this._http.post(`${c.API_BASE_URL}/api/Authentication/sendOtp/${encodeURIComponent(t)}`,null).pipe(a(p))}confirmEmail(t,e){return this._http.put(`${c.API_BASE_URL}/api/Authentication/confirmEmail`,{otp:t,email:e}).pipe(a(p))}forgetPassword(t){return this._http.post(`${c.API_BASE_URL}/api/Authentication/forgotPassword/${t}`,null).pipe(m(e=>{console.log(e),this._tokenService.setPasswordResetToken(e.passwordResetToken)}),a(e=>{throw console.error(e),e}))}resetPassword(t,e){let i=this._tokenService.getPasswordResetToken();if(!i)return k(()=>new Error("Reset token not found"));let R={email:t,token:i,newPassword:e};return this._http.put(`${c.API_BASE_URL}/api/Authentication/resetPassword`,R).pipe(m(()=>{this._tokenService.removePasswordResetToken()}),a(p))}isLoggedIn(){return this._tokenService.getToken()!==null}logout(){this._tokenService.removeToken(),this._tokenService.removeRefreshToken(),this._tokenService.clearRememberMe()}};o.\u0275fac=function(e){return new(e||o)(d(P),d(I))},o.\u0275prov=h({token:o,factory:o.\u0275fac,providedIn:"root"});let n=o;return n})();var H=(()=>{let o=class o{constructor(t,e){this._tokenService=t,this._http=e}get(){let t=this._tokenService.getUserId();return this._http.get(`${c.API_BASE_URL}/api/Profile/${t}`)}update(t){let e=this._tokenService.getUserId(),i={firstName:t.firstName,lastName:t.lastName,streetAddress:t.streetAddress,city:t.city,state:t.state,postalCode:t.postalCode,profilePicture:t.profilePicture};return this._http.put(`${c.API_BASE_URL}/api/Profile/${e}`,i).pipe(a(p))}delete(t){return this._http.delete(`${c.API_BASE_URL}/api/Profile/${t}`).pipe(a(p))}uploadProfilePicture(t){let e=this._tokenService.getUserId(),i=new FormData;return i.append("file",t,t.name),this._http.put(`${c.API_BASE_URL}/api/Profile/picture/${e}`,i).pipe(a(p))}getAllPlans(){return this._http.get(`${c.API_BASE_URL}/api/Plan`).pipe(a(p))}Subscribe(t){return this._http.post(c.API_BASE_URL+"/api/Profile/subscribe",t).pipe(a(p))}uploadWorkerDoc(t){let e=new FormData;e.append("file",t,t.name);let i=new A({accept:"*/*"});return this._http.put(`${c.API_BASE_URL}/api/Profile/worker/upload/doc`,e,{headers:i}).pipe(a(p))}};o.\u0275fac=function(e){return new(e||o)(d(I),d(P))},o.\u0275prov=h({token:o,factory:o.\u0275fac,providedIn:"root"});let n=o;return n})();var z=function(n){return n.Role_Admin="ADMIN",n.Role_Customer="CUSTOMER",n.Role_Worker="WORKER",n}(z||{});var u=Symbol("STATE_SIGNAL");function y(n,...o){n[u].update(r=>o.reduce((t,e)=>s(s({},t),typeof e=="function"?e(t):e),r))}function M(n){let o=D(()=>n());return J(o)?new Proxy(n,{get(r,t){return t in o?($(r[t])||Object.defineProperty(r,t,{value:E(()=>r()[t]),configurable:!0}),M(r[t])):r[t]}}):n}function J(n){return n?.constructor===Object}function N(...n){let o=[...n],r="providedIn"in o[0]?o.shift():{},t=o;return(()=>{class i{constructor(){let l=t.reduce((S,G)=>G(S),Q()),{slices:f,signals:w,methods:K,hooks:W}=l,T=s(s(s({},f),w),K);this[u]=l[u];for(let S in T)this[S]=T[S];let{onInit:L,onDestroy:b}=W;L&&L(),b&&_(U).onDestroy(b)}static \u0275fac=function(f){return new(f||i)};static \u0275prov=h({token:i,factory:i.\u0275fac,providedIn:r.providedIn||null})}return i})()}function Q(){return{[u]:B({}),slices:{},signals:{},methods:{},hooks:{}}}function v(n,o){return Object.keys(n).reduce((r,t)=>(o.includes(t)||(r[t]=n[t]),r),{})}function x(n){return o=>{let r=n(s(s(s({[u]:o[u]},o.slices),o.signals),o.methods)),t=Object.keys(r),e=v(o.slices,t),i=v(o.signals,t);return g(s({},o),{slices:e,signals:i,methods:s(s({},o.methods),r)})}}function O(n){return o=>{let r=typeof n=="function"?n():n,t=Object.keys(r);o[u].update(l=>s(s({},l),r));let e=t.reduce((l,f)=>{let w=E(()=>o[u]()[f]);return g(s({},l),{[f]:M(w)})},{}),i=v(o.signals,t),R=v(o.methods,t);return g(s({},o),{slices:s(s({},o.slices),e),signals:i,methods:R})}}var V={user:null,isLoading:!1},St=N({providedIn:"root"},O(V),x((n,o=_(H))=>({loadAll(){return j(this,null,function*(){y(n,{isLoading:!0});try{let t=yield o.get().toPromise();t||(t=n.user()),y(n,{user:t,isLoading:!1})}catch(t){console.error("Error fetching user profile",t),y(n,{isLoading:!1})}})}})));export{et as a,H as b,z as c,y as d,N as e,x as f,O as g,St as h};
